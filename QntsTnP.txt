SELECT DISTINCT UsageTnpRevenue.[Property Uid] AS UID, UsageTnpRevenue.[Gl Num] AS GL, UsageTnpRevenue.[Dest Name], UsageTnpRevenue.[Prop Name], UsageTnpRevenue.[Itinerary Number] AS Ittin, UsageTnpRevenue.[Membership Num], UsageTnpRevenue.[Created At], UsageTnpRevenue.[Begin Date], UsageTnpRevenue.[End Date] AS [End], UsageTnpRevenue.Days, UsageTnpRevenue.[Total Sale], IIf([Membership Num]=334105,"3rd Home",IIf([membership name]="API VacayStay Diamond Member","Diamond",IIf([membership num]=691684,"Diamond",IIf([membership name]="API VacayStay Diamond","DISC_Reseller",IIf([Membership Name]="API VacayStay Diamond Member","Diamond",[Membership Type]))))) AS Clubs, [Property TP].[Fin Type], [Property TP].Category, [Property TP].Latitude, [Property TP].Longitude
FROM UsageTnpRevenue LEFT JOIN [Property TP] ON UsageTnpRevenue.[Property Uid] = [Property TP].[Property Uid]
WHERE (((UsageTnpRevenue.[Total Sale])>0) AND ((IIf([Membership Num]=334105,"3rd Home",IIf([membership name]="API VacayStay Diamond Member","Diamond",IIf([membership num]=691684,"Diamond",IIf([membership name]="API VacayStay Diamond","DISC_Reseller",IIf([Membership Name]="API VacayStay Diamond Member","Diamond",[Membership Type])))))) In ("Time and Place Customer","Diamond")));

UNION ALL SELECT DISTINCT UsageQRevenue.property_uid AS UID, UsageQRevenue.general_ledger_number AS GL, UsageQRevenue.Destination AS [Dest Name], UsageQRevenue.property AS [Prop Name], UsageQRevenue.itinerary_number AS Ittin, UsageQRevenue.membership_num, UsageQRevenue.created_at, UsageQRevenue.[Reservation_ Begin] AS [Begin], UsageQRevenue.Reservation_End AS [End], UsageQRevenue.Nts AS Days, Nz([Tnp_Revenue])+Nz([Q_Revenue]) AS [Total Sale], IIf([membership_num]=334105,"3rd Home",IIf([membership_name]="API VacayStay Diamond Member","Diamond",IIf([membership_num]=691684,"Diamond",IIf([membership_name]="API VacayStay Diamond","DISC_Reseller",[club_ucode])))) AS Clubs, PropertyQuintess.[Fin Type], PropertyQuintess.Category, PropertyQuintess.Latitude, PropertyQuintess.Longitude
FROM UsageQRevenue LEFT JOIN PropertyQuintess ON UsageQRevenue.property_uid = PropertyQuintess.[Property Uid]
WHERE (((IIf([membership_num]=334105,"3rd Home",IIf([membership_name]="API VacayStay Diamond Member","Diamond",IIf([membership_num]=691684,"Diamond",IIf([membership_name]="API VacayStay Diamond","DISC_Reseller",[club_ucode]))))) Not In ("TIME_AND_PLACE","Diamond")));
